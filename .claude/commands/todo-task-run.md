---
description: TODOファイルからタスクを実行します[/todo-task-run xxx]
arguments:
  - name: file_path
    type: string
    required: true
    description: 実行対象のTODOファイルのパス
---

## context

## 📋 開発ルール

### 🚨 Lucas Rocha's micro-commit (詳細: CLAUDE.md)
- 1コミット1変更、テスト駆動変更サイクル厳守

### タスク完了時の手順

**重要**: タスクを完了した際は、必ず以下の手順を実行してください：

1. **タスクをチェック** - `- [ ]` を `- [x]` に変更
2. **関連ファイルを明記** - 作成・修正したファイル名を記載

### テストの実行

**重要**: **直近のpackage.jsonのtestコマンドを実行する**
          

## 📚 参考ドキュメント

- [関連ドキュメント一覧](@docs)

## 📋 調査結果保存ガイドライン

### メモリーファイルの命名規則
- **調査ファイル**: `/ai/projects/memory/investigation/YYYY-MM-DD-{topic}.md`
- **パターンファイル**: `/ai/projects/memory/patterns/{category}-{pattern-name}.md`
- **技術知見ファイル**: `/ai/projects/memory/insights/{technology}-{insight}.md`

### 保存すべき情報
- **調査プロセス**: 調査手法、使用したツール、参考資料
- **発見事項**: 重要な技術的発見、予想外の挙動や制約
- **解決策**: 問題解決方法、回避策、ベストプラクティス
- **影響範囲**: 他のコンポーネントへの影響、将来への示唆
- **参考情報**: 関連ドキュメント、外部リソース、コード例

### 保存タイミング
- **調査開始時**: 調査対象と目的を記録
- **重要発見時**: 調査途中でも即座に記録（後で統合）
- **タスク完了時**: 結果を整理・統合して最終版を作成
- **プロジェクト完了時**: 全体的な知見を抽象化・一般化

## ⚠️ 重要な制約事項

### Git操作に関する制約
- **ブランチの作成・切り替えを行わない** - 常に現在のブランチで作業する
- **プルリクエストを作成しない** - PR作成は明示的に禁止（ユーザーが手動で実行）
- **git pushを実行しない** - 変更のpushはユーザーに委ねる（72行目、103行目参照）
- **`ai/todo/`以下のファイルは絶対にコミットしない** - ローカルタスク管理用のため

これらの制約は、Task Tool経由で呼び出される全てのエージェントにも適用されます。

### MUST: コンテキスト残量が少なくなった場合の対応

コンテキスト（トークン）の残りが少なくなってきた場合：

1. **キリのいいところで作業を止める**
2. **進捗を保存する**
   - `$ARGUMENTS`: 完了タスク、進行中タスク、残タスクを更新
   - メモリーファイル: 調査結果や中間成果物を保存
3. **中断地点を明確に記録する**
   - 何が完了したか
   - 何が途中か
   - 次に何をすべきか
4. **ユーザーに中断を報告する**
   - 「コンテキストが少なくなったため中断します」と明示
   - 再開時に必要な情報を伝える

**理由**: セッションが途中で切れても、次のセッションで作業を継続できるようにするため。

## 処理フロー

### タスク作成 (Task Tool使用)
- $ARGUMENTSを読む
- $ARGUMENTSの内容を良く理解してタスク化してください
- TDDメソッド（ケント・ベックスタイル）を使用してタスク化
  - **Red**: 失敗する最小のテストを先に書く
  - **Green**: テストを通すための最小限のコードを書く  
  - **Refactor**: 重複を排除し、設計を改善する
  - 各サイクルは数分以内で完了させる
  - テストファーストで仕様を明確化してから実装開始
- タスクはTodosで保持
- 作成したtodoを$ARGUMENTSに追加

### 初期設定 (Task Tool使用)

### タスク実行 (各処理ごとにTask Toolを個別に使用)
- 実行前に `## 📋 ルール` の内容を復唱する
- 各タスクを順次実行
- **重要**: `git push` は実行しない。変更のpushはユーザーに委ねる
- **調査タスクの場合の追加手順**:
  - 調査開始時に`/ai/projects/memory/investigation/YYYY-MM-DD-{topic}.md`ファイルを作成
  - 重要な発見や知見は調査の途中でも即座にメモリーファイルに記録
  - 技術的パターンや再利用可能な知見は`/ai/projects/memory/patterns/`に分類保存
- **各タスク完了後の必須手順**:
  1. 変更をコミット（適切なコミットメッセージ付き）
     /commit コマンドを使用する
  2. **--no-prフラグが指定されていない場合のみ**: PRチェックリストを更新（ `- [ ]` → `- [x]` ）
  3. **$ARGUMENTSで指定されたファイルを更新**:
     - 完了したタスクを `- [ ]` から `- [x]` に変更
     - 関連ファイル情報を追記
     - 実装詳細や注意点を記録
  4. **調査結果の保存**:
     - 調査で得られた知見をメモリーファイルに統合・整理
     - 将来の参考となる技術的発見や課題解決方法を記録
     - 関連するドキュメントや参考資料のリンクを含める
  5. 実施した内容と更新結果を報告
- 未完了タスクがなくなるまで繰り返し
- 次のタスクの実行に必要な情報は、それまでに実行したタスクの戻り値等を適切に使用する

### 最終完了処理 (Task Tool使用)
**全タスク完了時の必須手順**:
1. **$ARGUMENTSで指定されたファイルの最終更新**:
   - 全タスクが完了状態（`- [x]`）になっていることを確認
   - 完了日時と全体的な実装サマリーを追記
   - 今後のメンテナンス時の参考情報を記録
2. **調査結果の最終統合**:
   - 全調査結果をメモリーファイルに最終整理
   - プロジェクト全体への影響や今後の展望を記録
   - 類似タスクでの参考情報として活用可能な形に整備
3. **pushについて**: 変更のpushはユーザーが適切なタイミングで実行する
